(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{2481:function(e,t,s){Promise.resolve().then(s.bind(s,7736))},7736:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var r=s(3827),l=s(4090),n=s(8792),i=s(7835),a=s(9315),c=s(1263),o=s(666),d=s(9686),u=s(3437),m=s(1886),h=s(1825),x=s(7397),g=s(8777);function f(){let[e,t]=(0,l.useState)(new Date),[s,f]=(0,l.useState)([]),[b,y]=(0,l.useState)(0),[p,j]=(0,l.useState)(null),[N,v]=(0,l.useState)([]),[w,k]=(0,l.useState)(!0),[_,M]=(0,l.useState)(null),[S,E]=(0,l.useState)(null),[D,I]=(0,l.useState)(""),[W,C]=(0,l.useState)(""),[U,H]=(0,l.useState)("");(0,l.useEffect)(()=>{console.log("Dashboard 페이지 로드됨"),console.log("Supabase URL:","설정됨"),console.log("Supabase Anon Key:","설정됨")},[]),(0,l.useEffect)(()=>{(async function(){try{k(!0),M(null);let e=await (0,g.F8)();console.log("Loaded entries:",e),f(e||[]);let t=0;e&&e.length>0&&e.forEach(e=>{e.working_hours&&(t+=e.working_hours)}),y(t),k(!1)}catch(e){console.error("Error loading time entries:",e),M("근무 기록을 불러오는 중 오류가 발생했습니다: ".concat(e.message||String(e))),k(!1)}})()},[]);let J=(0,c.N)(e),O=(0,o.V)(e),A=(0,d.D)({start:J,end:O}),F=(0,u.w)(J),T=e=>{j(e),v(s.filter(t=>t.date===e))};function L(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=Math.floor(e),r=Math.round((e-s)*60);return t?"".concat(s,".").concat(Math.floor(r/6),"h"):"".concat(s,"시간 ").concat(r,"분")}let q=e=>{E(e),I(e.date),C(e.check_in?(0,m.WU)((0,h.D)(e.check_in),"HH:mm"):""),H(e.check_out?(0,m.WU)((0,h.D)(e.check_out),"HH:mm"):"")},z=()=>{E(null)},X=async()=>{if(S)try{k(!0),M(null);let[e,t,s]=D.split("-").map(Number),r=new Date(e,t-1,s),[l,n]=W.split(":").map(Number),i=new Date(r);i.setHours(l,n,0);let a=null;if(U){let[e,t]=U.split(":").map(Number);(a=new Date(r)).setHours(e,t,0)}let c=null;if(i&&a){let e=a.getTime()-i.getTime();e<0&&(e+=864e5),c=e/36e5}if(await (0,g.Dg)(S.id,i.toISOString(),a?a.toISOString():null,c,D)){E(null);let e=await (0,g.F8)();if(f(e||[]),p){let t=e.filter(e=>e.date===p);v(t)}if(D!==S.date){j(D);let t=e.filter(e=>e.date===D);v(t)}}}catch(e){console.error("Error updating entry:",e),M("기록 수정 중 오류가 발생했습니다.")}finally{k(!1)}},R=async e=>{try{if(k(!0),M(null),await (0,g.eh)(e)){let e=await (0,g.F8)();if(f(e||[]),p){let t=e.filter(e=>e.date===p);v(t)}}}catch(e){console.error("Error deleting entry:",e),M("기록 삭제 중 오류가 발생했습니다.")}finally{k(!1)}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"근무 기록 대시보드"}),(0,r.jsx)(n.default,{href:"/timer",className:"bg-primary text-white px-4 py-2 rounded hover:bg-blue-700",children:"출퇴근 기록"})]}),w&&(0,r.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"ml-3",children:"데이터를 불러오는 중..."})]}),_&&(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:[(0,r.jsx)("p",{children:_}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"Supabase 연결 및 환경 변수를 확인해주세요."})]}),!w&&!_&&(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"근무 시간 요약"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"총 근무 시간"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:L(b)})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"이번 달 근무 일수"}),(0,r.jsxs)("p",{className:"text-2xl font-bold",children:[s.filter(t=>t.date.startsWith((0,m.WU)(e,"yyyy-MM"))).length>0?Array.from(new Set(s.filter(t=>t.date.startsWith((0,m.WU)(e,"yyyy-MM"))).map(e=>e.date))).length:0,"일"]})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"80시간 중 남은 시간"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:b<80?L(80-b):"0시간 0분"})]})]})]}),!w&&!_&&(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("button",{onClick:()=>{t((0,i.W)(e,1))},className:"p-2 rounded-full hover:bg-gray-100",children:"<"}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:(0,m.WU)(e,"yyyy년 MM월",{locale:x.ko})}),(0,r.jsx)("button",{onClick:()=>{t((0,a.z)(e,1))},className:"p-2 rounded-full hover:bg-gray-100",children:">"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-7 gap-1",children:[["일","월","화","수","목","금","토"].map(e=>(0,r.jsx)("div",{className:"text-center font-semibold p-2",children:e},e)),Array.from({length:F}).map((e,t)=>(0,r.jsx)("div",{className:"p-2"},"empty-".concat(t))),A.map(e=>{let t=(0,m.WU)(e,"yyyy-MM-dd"),l=s.filter(e=>e.date===t),n=l.length>0,i=p===t,a="";if(n){let e=l.reduce((e,t)=>e+(t.working_hours||0),0);e>=8?a="bg-green-100":e>=4?a="bg-yellow-100":e>0&&(a="bg-red-100")}return(0,r.jsxs)("div",{className:"p-2 min-h-[60px] border ".concat(i?"border-blue-500":"border-gray-200"," ").concat(a," cursor-pointer hover:bg-gray-50"),onClick:()=>T(t),children:[(0,r.jsx)("div",{className:"font-medium ".concat(6===(0,u.w)(e)?"text-blue-600":0===(0,u.w)(e)?"text-red-600":""),children:(0,m.WU)(e,"d")}),n&&(0,r.jsx)("div",{className:"text-xs mt-1 text-gray-600",children:L(l.reduce((e,t)=>e+(t.working_hours||0),0),!0)})]},t)})]})]}),N.length>0?(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:[p?(0,m.WU)((0,h.D)(p),"yyyy년 MM월 dd일"):(0,m.WU)(new Date,"yyyy년 MM월 dd일")," 출퇴근 기록"]}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:N.map(e=>(0,r.jsx)("div",{className:"relative",children:(null==S?void 0:S.id)===e.id?(0,r.jsxs)("div",{className:"p-4 bg-blue-50",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"날짜"}),(0,r.jsx)("input",{type:"date",value:D,onChange:e=>I(e.target.value),className:"border rounded px-2 py-1 w-full"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"출근 시간"}),(0,r.jsx)("input",{type:"time",value:W,onChange:e=>C(e.target.value),className:"border rounded px-2 py-1 w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"퇴근 시간"}),(0,r.jsx)("input",{type:"time",value:U,onChange:e=>H(e.target.value),className:"border rounded px-2 py-1 w-full"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)("button",{onClick:X,className:"bg-green-500 text-white px-4 py-1 rounded text-sm",children:"저장"}),(0,r.jsx)("button",{onClick:z,className:"bg-gray-500 text-white px-4 py-1 rounded text-sm",children:"취소"})]})]}):(0,r.jsxs)("div",{className:"group overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute right-0 top-0 bottom-0 bg-red-500 text-white flex items-center justify-center w-16 transform translate-x-full group-hover:translate-x-0 transition-transform duration-200",children:(0,r.jsx)("button",{onClick:()=>R(e.id),className:"w-full h-full flex items-center justify-center",children:"삭제"})}),(0,r.jsxs)("div",{className:"p-4 bg-white flex justify-between items-center transform group-hover:-translate-x-16 transition-transform duration-200 cursor-pointer",onClick:()=>q(e),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-blue-100 text-blue-800 rounded-full w-8 h-8 flex items-center justify-center",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"font-medium text-sm",children:[e.check_in?(0,m.WU)((0,h.D)(e.check_in),"HH:mm"):"-"," ~ ",e.check_out?(0,m.WU)((0,h.D)(e.check_out),"HH:mm"):"진행중"]})})]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:e.working_hours?L(e.working_hours,!0):"-"})]})]})},e.id))})})]}):p&&(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:[p?(0,m.WU)((0,h.D)(p),"yyyy년 MM월 dd일"):(0,m.WU)(new Date,"yyyy년 MM월 dd일")," 출퇴근 기록"]}),(0,r.jsx)("p",{className:"text-gray-500 text-center py-4",children:"선택한 날짜의 출퇴근 기록이 없습니다."})]})]})}},8777:function(e,t,s){"use strict";s.d(t,{lp:function(){return n},eh:function(){return c},F8:function(){return o},Av:function(){return l},se:function(){return i},Dg:function(){return a}});let r=(0,s(3549).eI)("https://ijsggnmyblatollrvkhf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlqc2dnbm15YmxhdG9sbHJ2a2hmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkxOTk4NjMsImV4cCI6MjA2NDc3NTg2M30.K0y7U_XEuXJQRx_PZ_uFJy62Wal3bM4OT2eVM6mdHHQ");async function l(e){let{data:t,error:s}=await r.from("time_entries").select("*").eq("date",e).order("check_in",{ascending:!0});return s?(console.error("Error fetching time entries:",s),[]):t}async function n(e,t){let{data:s,error:l}=await r.from("time_entries").insert([{date:e,check_in:t,check_out:null,working_hours:null}]).select();return l?(console.error("Error creating check-in entry:",l),null):s[0]}async function i(e,t,s){let{data:l,error:n}=await r.from("time_entries").update({check_out:t,working_hours:s}).eq("id",e).select();return n?(console.error("Error updating check-out entry:",n),null):l[0]}async function a(e,t,s,l,n){let i={check_in:t,check_out:s,working_hours:l};n&&(i.date=n);let{data:a,error:c}=await r.from("time_entries").update(i).eq("id",e).select();return c?(console.error("Error updating time entry:",c),null):a[0]}async function c(e){let{error:t}=await r.from("time_entries").delete().eq("id",e);return!t||(console.error("Error deleting time entry:",t),!1)}async function o(){console.log("getAllTimeEntries 함수 호출됨"),console.log("Supabase URL:","https://ijsggnmyblatollrvkhf.supabase.co"),console.log("Supabase Key 설정 여부:",!0);try{let{data:e,error:t}=await r.from("time_entries").select("*").order("date",{ascending:!1});if(t)return console.error("Error fetching all time entries:",t),[];return console.log("가져온 데이터 수:",e?e.length:0),e||[]}catch(e){return console.error("Exception in getAllTimeEntries:",e),[]}}}},function(e){e.O(0,[792,389,400,971,69,744],function(){return e(e.s=2481)}),_N_E=e.O()}]);
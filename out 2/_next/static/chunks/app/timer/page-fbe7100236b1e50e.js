(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[498],{8647:function(e,t,n){Promise.resolve().then(n.bind(n,6189))},6189:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(3827),l=n(4090),s=n(8792),i=n(1886),a=n(1825),c=n(8777);function o(){let[e,t]=(0,l.useState)(!1),[n,o]=(0,l.useState)(null),[u,d]=(0,l.useState)(null),[m,h]=(0,l.useState)(null),[x,f]=(0,l.useState)([]),[g,p]=(0,l.useState)(null),[N,y]=(0,l.useState)(""),[b,w]=(0,l.useState)(""),[j,v]=(0,l.useState)(""),[D,k]=(0,l.useState)(!1),[_,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{E()},[]);let[C,I]=(0,l.useState)(null),[T,U]=(0,l.useState)(!1);(0,l.useEffect)(()=>{U(!0),I(new Date);let e=setInterval(()=>{I(new Date)},1e3);return()=>clearInterval(e)},[]);let E=async()=>{k(!0),S(null);try{let e=(0,i.WU)(new Date,"yyyy-MM-dd"),n=await (0,c.Av)(e);if(f(n),n.length>0){let e=n[n.length-1];e&&e.check_in&&!e.check_out?(t(!0),o(new Date(e.check_in))):t(!1)}else t(!1)}catch(e){console.error("Error loading today's records:",e),S("기록을 불러오는 중 오류가 발생했습니다.")}finally{k(!1)}},M=async()=>{try{k(!0),S(null);let e=new Date,n=(0,i.WU)(e,"yyyy-MM-dd");await (0,c.lp)(n,e.toISOString())&&(t(!0),o(e),d(null),h(null),E())}catch(e){console.error("Error checking in:",e),S("출근 처리 중 오류가 발생했습니다.")}finally{k(!1)}},H=async()=>{if(n)try{k(!0),S(null);let e=new Date,r=(e.getTime()-n.getTime())/36e5,l=Math.floor(r),s="".concat(l,"시간 ").concat(Math.round((r-l)*60),"분");if(x.length>0){let n=x[x.length-1];await (0,c.se)(n.id,e.toISOString(),r)&&(t(!1),d(e),h(s),E())}}catch(e){console.error("Error checking out:",e),S("퇴근 처리 중 오류가 발생했습니다.")}finally{k(!1)}},J=e=>{p(e),y(e.date),w(e.check_in?(0,i.WU)((0,a.D)(e.check_in),"HH:mm"):""),v(e.check_out?(0,i.WU)((0,a.D)(e.check_out),"HH:mm"):"")},W=()=>{p(null)},O=async()=>{if(g)try{k(!0),S(null);let[e,t,n]=N.split("-").map(Number),r=new Date(e,t-1,n),[l,s]=b.split(":").map(Number),i=new Date(r);i.setHours(l,s,0);let a=null;if(j){let[e,t]=j.split(":").map(Number);(a=new Date(r)).setHours(e,t,0)}let o=null;if(i&&a){let e=a.getTime()-i.getTime();e<0&&(e+=864e5),o=e/36e5}await (0,c.Dg)(g.id,i.toISOString(),a?a.toISOString():null,o,N)&&(p(null),E())}catch(e){console.error("Error updating entry:",e),S("기록 수정 중 오류가 발생했습니다.")}finally{k(!1)}},z=async e=>{try{k(!0),S(null),await (0,c.eh)(e)&&E()}catch(e){console.error("Error deleting entry:",e),S("기록 삭제 중 오류가 발생했습니다.")}finally{k(!1)}},Z=e=>{if(null===e)return"-";let t=Math.floor(e);return"".concat(t,"시간 ").concat(Math.round((e-t)*60),"분")};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"출퇴근 기록"}),(0,r.jsx)(s.default,{href:"/dashboard",className:"bg-primary text-white px-4 py-2 rounded hover:bg-blue-700",children:"대시보드로 이동"})]}),D&&(0,r.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6 text-center",children:(0,r.jsx)("p",{className:"text-blue-700",children:"기록을 불러오는 중..."})}),_&&(0,r.jsx)("div",{className:"bg-red-50 p-4 rounded-lg mb-6",children:(0,r.jsx)("p",{className:"text-red-700",children:_})}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center bg-white shadow rounded-lg p-8 mb-6",children:[(0,r.jsx)("div",{className:"text-xl mb-6",children:T?(0,i.WU)(C||new Date,"yyyy년 MM월 dd일"):""}),(0,r.jsx)("div",{className:"text-4xl font-mono mb-6",children:T?(0,i.WU)(C||new Date,"HH:mm:ss"):""}),(0,r.jsx)("div",{className:"flex space-x-4",children:e?(0,r.jsx)("button",{className:"bg-red-500 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-red-600",onClick:H,disabled:D,children:"퇴근하기"}):(0,r.jsx)("button",{className:"bg-green-500 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-green-600",onClick:M,disabled:D,children:"출근하기"})})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"오늘의 출퇴근 기록"}),D?(0,r.jsx)("p",{className:"text-center py-4",children:"기록을 불러오는 중..."}):x.length>0?(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:x.map(e=>(0,r.jsx)("div",{className:"relative",children:(null==g?void 0:g.id)===e.id?(0,r.jsxs)("div",{className:"p-4 bg-blue-50",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"날짜"}),(0,r.jsx)("input",{type:"date",value:N,onChange:e=>y(e.target.value),className:"border rounded px-2 py-1 w-full"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"출근 시간"}),(0,r.jsx)("input",{type:"time",value:b,onChange:e=>w(e.target.value),className:"border rounded px-2 py-1 w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"퇴근 시간"}),(0,r.jsx)("input",{type:"time",value:j,onChange:e=>v(e.target.value),className:"border rounded px-2 py-1 w-full"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)("button",{onClick:O,className:"bg-green-500 text-white px-4 py-1 rounded text-sm",children:"저장"}),(0,r.jsx)("button",{onClick:W,className:"bg-gray-500 text-white px-4 py-1 rounded text-sm",children:"취소"})]})]}):(0,r.jsxs)("div",{className:"group overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute right-0 top-0 bottom-0 bg-red-500 text-white flex items-center justify-center w-16 transform translate-x-full group-hover:translate-x-0 transition-transform duration-200",children:(0,r.jsx)("button",{onClick:()=>z(e.id),className:"w-full h-full flex items-center justify-center",children:"삭제"})}),(0,r.jsxs)("div",{className:"p-4 bg-white flex justify-between items-center transform group-hover:-translate-x-16 transition-transform duration-200 cursor-pointer",onClick:()=>J(e),children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.check_in?(0,i.WU)(new Date(e.check_in),"HH:mm"):"-"," ~ ",e.check_out?(0,i.WU)(new Date(e.check_out),"HH:mm"):"진행중"]}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.working_hours?Z(e.working_hours):"-"})]}),(0,r.jsx)("div",{className:"text-gray-400",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})})]})]})},e.id))})}):(0,r.jsx)("p",{className:"text-gray-500 text-center py-4",children:"오늘의 출퇴근 기록이 없습니다."})]}),(n||u)&&(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"현재 상태"}),(0,r.jsxs)("div",{className:"space-y-3",children:[n&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"출근 시간:"}),(0,r.jsx)("span",{className:"font-medium",children:(0,i.WU)(n,"HH:mm:ss")})]}),u&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"퇴근 시간:"}),(0,r.jsx)("span",{className:"font-medium",children:(0,i.WU)(u,"HH:mm:ss")})]}),m&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"근무 시간:"}),(0,r.jsx)("span",{className:"font-medium",children:m})]})]})]})]})}},8777:function(e,t,n){"use strict";n.d(t,{lp:function(){return s},eh:function(){return c},F8:function(){return o},Av:function(){return l},se:function(){return i},Dg:function(){return a}});let r=(0,n(3549).eI)("https://ijsggnmyblatollrvkhf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlqc2dnbm15YmxhdG9sbHJ2a2hmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkxOTk4NjMsImV4cCI6MjA2NDc3NTg2M30.K0y7U_XEuXJQRx_PZ_uFJy62Wal3bM4OT2eVM6mdHHQ");async function l(e){let{data:t,error:n}=await r.from("time_entries").select("*").eq("date",e).order("check_in",{ascending:!0});return n?(console.error("Error fetching time entries:",n),[]):t}async function s(e,t){let{data:n,error:l}=await r.from("time_entries").insert([{date:e,check_in:t,check_out:null,working_hours:null}]).select();return l?(console.error("Error creating check-in entry:",l),null):n[0]}async function i(e,t,n){let{data:l,error:s}=await r.from("time_entries").update({check_out:t,working_hours:n}).eq("id",e).select();return s?(console.error("Error updating check-out entry:",s),null):l[0]}async function a(e,t,n,l,s){let i={check_in:t,check_out:n,working_hours:l};s&&(i.date=s);let{data:a,error:c}=await r.from("time_entries").update(i).eq("id",e).select();return c?(console.error("Error updating time entry:",c),null):a[0]}async function c(e){let{error:t}=await r.from("time_entries").delete().eq("id",e);return!t||(console.error("Error deleting time entry:",t),!1)}async function o(){console.log("getAllTimeEntries 함수 호출됨"),console.log("Supabase URL:","https://ijsggnmyblatollrvkhf.supabase.co"),console.log("Supabase Key 설정 여부:",!0);try{let{data:e,error:t}=await r.from("time_entries").select("*").order("date",{ascending:!1});if(t)return console.error("Error fetching all time entries:",t),[];return console.log("가져온 데이터 수:",e?e.length:0),e||[]}catch(e){return console.error("Exception in getAllTimeEntries:",e),[]}}},1825:function(e,t,n){"use strict";n.d(t,{D:function(){return l}});var r=n(1562);function l(e,t){var n;let l,h;let x=null!==(n=null==t?void 0:t.additionalDigits)&&void 0!==n?n:2,f=function(e){let t;let n={},r=e.split(s.dateTimeDelimiter);if(r.length>2)return n;if(/:/.test(r[0])?t=r[0]:(n.date=r[0],t=r[1],s.timeZoneDelimiter.test(n.date)&&(n.date=e.split(s.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length))),t){let e=s.timezone.exec(t);e?(n.time=t.replace(e[1],""),n.timezone=e[1]):n.time=t}return n}(e);if(f.date){let e=function(e,t){let n=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};let l=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:null===s?l:100*s,restDateString:e.slice((r[1]||r[2]).length)}}(f.date,x);l=function(e,t){if(null===t)return new Date(NaN);let n=e.match(i);if(!n)return new Date(NaN);let r=!!n[4],l=o(n[1]),s=o(n[2])-1,a=o(n[3]),c=o(n[4]),u=o(n[5])-1;if(r)return c>=1&&c<=53&&u>=0&&u<=6?function(e,t,n){let r=new Date(0);r.setUTCFullYear(e,0,4);let l=r.getUTCDay()||7;return r.setUTCDate(r.getUTCDate()+((t-1)*7+n+1-l)),r}(t,c,u):new Date(NaN);{let e=new Date(0);return s>=0&&s<=11&&a>=1&&a<=(d[s]||(m(t)?29:28))&&l>=1&&l<=(m(t)?366:365)?(e.setUTCFullYear(t,s,Math.max(l,a)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!l||isNaN(l.getTime()))return new Date(NaN);let g=l.getTime(),p=0;if(f.time&&isNaN(p=function(e){let t=e.match(a);if(!t)return NaN;let n=u(t[1]),l=u(t[2]),s=u(t[3]);return(24===n?0===l&&0===s:s>=0&&s<60&&l>=0&&l<60&&n>=0&&n<25)?n*r.vh+l*r.yJ+1e3*s:NaN}(f.time)))return new Date(NaN);if(f.timezone){if(isNaN(h=function(e){if("Z"===e)return 0;let t=e.match(c);if(!t)return 0;let n="+"===t[1]?-1:1,l=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return s>=0&&s<=59?n*(l*r.vh+s*r.yJ):NaN}(f.timezone)))return new Date(NaN)}else{let e=new Date(g+p),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(g+p+h)}let s={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},i=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,a=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,c=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(e){return e?parseInt(e):1}function u(e){return e&&parseFloat(e.replace(",","."))||0}let d=[31,null,31,30,31,30,31,31,30,31,30,31];function m(e){return e%400==0||e%4==0&&e%100!=0}}},function(e){e.O(0,[792,389,971,69,744],function(){return e(e.s=8647)}),_N_E=e.O()}]);